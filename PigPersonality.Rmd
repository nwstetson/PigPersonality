---
title: "Pig Personality"
author: "Noah Stetson"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Analyzing data on personality in pigs, using both observational and informant assessment data

Loading library
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

Loading dataset (for observational, survey, and meta data about pigs)
```{r}
obs <- read_csv("~/Documents/GitHub/PigPersonality/obsData_30Sept.csv")
svy <- read_csv("~/Documents/GitHub/PigPersonality/CaregiverSurveyMOCK.csv")
meta <- read_csv("~/Documents/GitHub/PigPersonality/PigSample.csv")
```
it won't let me open files from documents, only from desktop ðŸ˜³ so my working director must have been set to my desktop, but when I try to fix it it doesn't work!

Temporary fix, open copies from using base (readr)

## Cleaning Data

Change "name" in metadata to "pig" so the files can be combined
```{r}
colnames(meta) [colnames(meta) == "Name"] <- "Pig"
```

Put meta data into df based on pig
```{r}
obs_m <- inner_join(obs, meta, by = "Pig") 
```
Wait why did it change from 475 objects to 472? It deleted 2 rows?
Oh they were rows with "no value" as the pig name so they need to be omitted

# Find most common observed behaviors
```{r}
obs_m %>% 
  count(Behavior) %>% 
  ggplot(aes(x = Behavior, y = n)) +
  geom_bar(stat = "identity") +
  labs(title = "Frequency of Behaviors") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
  theme_linedraw() +
  theme(axis.ticks = element_blank(),
        axis.title = element_blank(),
        panel.grid.major.x = element_blank())
```

```{r}
ggplot (obs_m, aes(x= Behavior)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Food Grasping Between Individuals") +
  facet_wrap (~ Focal)
```
