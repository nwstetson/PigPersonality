---
title: "Pig Personality"
author: "Noah Stetson"
date: "`r Sys.Date()`"
format: html
editor: visual
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## This is the analysis for my undergraduate thesis on personality in pigs üê∑

## üêΩ = questions I have

## Loading library

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(corrr) # might not need this
library(psych) # might not need this
library(irr) # might not need this
library(readr)
library(corrplot) # might not need this
library(irr)
```

## Loading datasets

Pulled from GitHub so you don't need to change these or download the CSV files!!

```{r}
obs <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/behavior_data/Obs_Clean.csv", show_col_types = FALSE)  # behavior observations

behavior_counts <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/behavior_data/behavior_counts.csv", show_col_types = FALSE) # behavior observations but tidyer

svy <-read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/survey_data/Survey_Nov7_Clean.csv", show_col_types = FALSE)  # survey data

svy_by_rater <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/survey_data/svy_with_averages.csv", show_col_types = FALSE) # survey data (but with scores split between raters)

D_svy <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/survey_data/svy_D.csv", show_col_types = FALSE) # survey data from rater D

T_svy <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/survey_data/svy_T.csv", show_col_types = FALSE) # survey data from rater T

Avg_svy <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/survey_data/svy_Avg.csv", show_col_types = FALSE) # survey data from averages of raters

meta <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/PigSample.csv", show_col_types = FALSE) # meta data (pig demographics)
```

## Cleaning Data

Put meta data into df based on pig id number

```{r}
svy_m <- inner_join(meta, svy, by = "PigID")
obs_m <- inner_join(meta, obs, by = "PigName")
svy_avg_m <- inner_join(meta, svy_by_rater, by = "PigID")
```

### Survey data

Test items only version

```{r}
svy_items <- svy_avg_m %>% select(1:12,'Time.Known.D','Time.Known.T','Time.Known.Avg','D1.D':'D35.D','D1.T':'D35.T','D1.Avg':'D35.Avg')
```

Facet scores only version

```{r}
svy_f <- svy_avg_m %>% select(1:12,'Time.Known.D','Time.Known.T','Time.Known.Avg','F1.D':'F4.D','F1.T':'F4.T','F1.Avg':'F4.Avg')
```

Sub-facet scores only version

```{r}
svy_sf <- svy_avg_m %>% select(1:12,'Time.Known.D','Time.Known.T','Time.Known.Avg','SC1.D':'SC12.D','SC1.T':'SC12.T','SC1.Avg':'SC12.Avg') # All of them
```

### Make wide/tidy(?) version of survey results

Items

```{r}
items_tidy <-svy_items %>% 
  pivot_longer(cols = 'Time.Known.D':'Time.Known.Avg', names_to = "Time.Known", values_to = 'Time.Known.Value')
items_tidy <-items_tidy %>% 
  pivot_longer(cols = 'D1.D':'D35.D', names_to = "item.D", values_to = 'item.D.value')
items_tidy <-items_tidy %>% 
  pivot_longer(cols = 'D1.T':'D35.T', names_to = "item.T", values_to = 'item.T.value')
items_tidy <-items_tidy %>% 
  pivot_longer(cols = 'D1.Avg':'D35.Avg', names_to = "item.Avg", values_to = 'item.Avg.value')
```

Facet scores

```{r}
facets_tidy <-svy_f %>% 
  pivot_longer(cols = 'Time.Known.D':'Time.Known.Avg', names_to = "Time.Known", values_to = 'Time.Known.Value')
facets_tidy <-facets_tidy %>% 
  pivot_longer(cols = 'F1.D':'F4.D', names_to = "facet.D", values_to = 'facet.D.value')
facets_tidy <-facets_tidy %>% 
  pivot_longer(cols = 'F1.T':'F4.T', names_to = "facet.T", values_to = 'facet.T.value')
facets_tidy <-facets_tidy %>% 
  pivot_longer(cols = 'F1.Avg':'F4.Avg', names_to = "facet.Avg", values_to = 'facet.Avg.value')
```

Sub-facet scores

```{r}
subfacets_tidy <-svy_sf %>% 
  pivot_longer(cols = 'Time.Known.D':'Time.Known.Avg', names_to = "Time.Known", values_to = 'Time.Known.Value')
subfacets_tidy <-subfacets_tidy %>% 
  pivot_longer(cols = 'SC1.D':'SC12.D', names_to = "subfacet.D", values_to = 'subfacet.D.value')
subfacets_tidy <-subfacets_tidy %>% 
  pivot_longer(cols = 'SC1.T':'SC12.T', names_to = "subfacet.T", values_to = 'subfacet.T.value')
subfacets_tidy <-subfacets_tidy %>% 
  pivot_longer(cols = 'SC1.Avg':'SC12.Avg', names_to = "subfacet.Avg", values_to = 'subfacet.Avg.value')
```

### Behavior Observations

```{r}
# Make wide version
behavior_counts_wide <-behavior_counts %>% 
  pivot_longer(cols = 2:21 , names_to = "Behavior", values_to = 'Count')


# Also make verion with meta data
behavior_m <- inner_join(behavior_counts, meta, by = "PigName")
```

# Preliminary Analyses

## Overview of Personality Survey Scores

Item rating

```{r}
all_items <- svy_items %>% select(16:120)
describe(all_items)
```

Sub-facet scores

```{r}
all_sf <- svy_sf %>% select(16:51)
describe(all_sf)
```

### As a graph

üêΩ What kind of visualization could I use to summarize this better?

## Sort by main facet

```{r}
facets_tidy$facet.Avg <- factor(facets_tidy$facet.Avg, levels=rev(unique(facets_tidy$facet.Avg)))


ggplot(facets_tidy, aes(x= facet.Avg, y= facet.Avg.value)) +
  geom_boxplot(color = "navy", fill='lightsteelblue1') +
  theme_classic() +
  xlab("Personality Facet") +
  ylab("Score") +
  coord_flip() +
  ggtitle("Variation in Personality Scores Across 20 Pigs")
```

## Sub-facets

```{r}
subfacets_tidy$subfacet.Avg <- factor(subfacets_tidy$subfacet.Avg, levels=rev(unique(subfacets_tidy$subfacet.Avg)))


ggplot(subfacets_tidy, aes(x= subfacet.Avg, y= subfacet.Avg.value)) +
  geom_boxplot(color = "navy", fill='lightsteelblue1') +
  theme_classic() +
  xlab("Personality Sub-Facet") +
  ylab("Score") +
  coord_flip() +
  ggtitle("Variation in Personality Scores Across 20 Pigs")
```

## Overview of Behaviors

### As a graph

```{r}
ggplot(behavior_counts_wide, aes(x= Behavior, y= Count)) +
  geom_boxplot(color = "navy", fill='lightsteelblue1') +
  theme_classic() +
  xlab("Behavior") +
  ylab("Counts") +
  ggtitle("Differences in Behavior Between Pigs")
```

## Internal Reliability

### Inter-item correlation

(correlations between each pig's average raw item scores)

### Overall

```{r}
item_matrix_table <- cor(svy_by_rater[,c(3:37)]) #3:37 is the test items
corrplot(item_matrix_table, addCoef.col = 1,
         number.cex = 0.3, tl.cex = 0.5)
```

```{r}
avg_items <- Avg_svy %>% select(3:37)
inter_item <- avg_items %>% correlate() %>% select(-term)

inter <- colMeans(inter_item, na.rm = TRUE)

mean(inter)
# 0.00679244

```

### By facet

Fearfulness

```{r}
avg_f1 <- Avg_svy %>% select(D1.Avg, D5.Avg, D23.Avg, D3.Avg, D8.Avg, D19.Avg, D10.Avg, D18.Avg, D33.Avg, D13.Avg, D28.Avg, D34.Avg)
inter_f1 <- avg_f1 %>% correlate() %>% select(-term)

inter_f1 <- colMeans(inter_f1, na.rm = TRUE)

mean(inter_f1)
# 0.08263553 (low)

psych::alpha(avg_f1)
# 0.47 (unacceptable)
```

Aggression Towards Humans

```{r}
avg_f2 <- Avg_svy %>% select(D6.Avg, D15.Avg, D31.Avg, D21.Avg, D25.Avg, D29.Avg)
inter_f2 <- avg_f2 %>% correlate() %>% select(-term)

inter_f2 <- colMeans(inter_f2, na.rm = TRUE)

mean(inter_f2)
# 0.3979195 (low)

psych::alpha(avg_f2)
# alpha: 0.75 (questionable)
```

Activity/Excitability

```{r}
avg_f3 <- Avg_svy %>% select(D12.Avg, D26.Avg, D32.Avg, D7.Avg, D14.Avg, D4.Avg, D11.Avg, D20.Avg, D17.Avg, D22.Avg, D30.Avg)
inter_f3 <- avg_f3 %>% correlate() %>% select(-term)

inter_f3 <- colMeans(inter_f3, na.rm = TRUE)

mean(inter_f3)
# 0.06783288 (low)

psych::alpha(avg_f3)
# 0.55 (poor)
```

Aggression/Dominance towards Pigs

```{r}
avg_f4 <- Avg_svy %>% select(D2.Avg, D16.Avg, D27.Avg, D9.Avg, D24.Avg, D35.Avg)
inter_f4 <- avg_f4 %>% correlate() %>% select(-term)

inter_f4 <- colMeans(inter_f4, na.rm = TRUE)

mean(inter_f4)
#0.1235088 (low)

psych::alpha(avg_f4)
# 0.56 (poor)
```

### Inter-total correlation

(correlations between calculated personality sub-facet scores)

```{r}
svy_matrix_table <- cor(svy_by_rater[,c(38:49)]) #38:39 is the sub-facets

corrplot(svy_matrix_table, addCoef.col = 1,
         number.cex = 0.6, tl.cex = 0.7)
```

```{r}
avg_sf <- Avg_svy %>% select(38:49)
inter_total_sf <- avg_sf %>% correlate() %>% select(-term)
inter_total_sf_no_na <- colMeans(inter_total_sf, na.rm = TRUE)
```

## Inter-rater Reliability

Do rater 1 and rater 2 score each pig in a similar way?

üêΩ How do I calculate the correlation between these?

Make a new df because my brain is so smooth I literally cannot figure out how else to do it what if i killed myself right now

```{r}
svy_wide <-svy_m %>% 
  pivot_longer(cols = 15:49, names_to = "item", values_to = 'item.value')
svy_wide <- svy_wide %>% 
  pivot_longer(cols = 15:26, names_to = "sub.facet", values_to ='subfacet.value')
svy_wide <- svy_wide %>% 
  pivot_longer(cols = 15:18, names_to = "facet", values_to = 'facet.value')
```

```{r}
svy_wide$sub.facet <- factor(svy_wide$sub.facet, levels=rev(unique(svy_wide$sub.facet)))
#this reorders the tick marks so it's not out of order
# why didn't it do it

ggplot(svy_wide, aes(x= sub.facet, y= subfacet.value, fill = Rater)) +
  geom_boxplot() +
  theme_classic() +
  scale_fill_manual(values = c("powderblue", "goldenrod1")) + #change colors and add outline
  xlab("Personality Sub-Facet") +
  ylab("Score") +
  ggtitle("Variation in Personality Scores Across 20 Pigs")
```

### Cohen's Kappa

I generated all these data frames by hand because I am stupid and dumb and a silly little goose

#### How to interpret:

0 or less: No agreement

0.01-0.20: None to slight

0.21-0.40: Fair

0.41-0.60: Moderate

0.61-0.80: Substantial

0.81-1.00: Almost perfect

#### SC1 (Fear of Humans)

Kappa = 0.27

```{r}
irr_sc1 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc1.csv", show_col_types = FALSE)

kappa2(irr_sc1[,c(1,2)], "equal")
```

#### SC2 (Nonsocial Fear)

Kappa = 0.167

```{r}
irr_sc2 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc2.csv", show_col_types = FALSE)

kappa2(irr_sc2[,c(1,2)], "equal")
```

#### SC3 (Fear of Pigs)

Kappa = 0.0832

```{r}
irr_sc3 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc3.csv", show_col_types = FALSE)
 
kappa2(irr_sc3[,c(1,2)], "equal")
```

#### SC4 (Fear of Handling)

Kappa = 0.27

```{r}
irr_sc4 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc4.csv", show_col_types = FALSE)
kappa2(irr_sc4[,c(1,2)], "equal")
```

#### SC5 (General Aggression)

Kappa = 0.202

```{r}
irr_sc5 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc5.csv", show_col_types = FALSE)

kappa2(irr_sc5[,c(1,2)], "equal")
```

#### SC6 (Situational Aggression)

Kappa = -0.0165

```{r}
irr_sc6 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc6.csv", show_col_types = FALSE)

kappa2(irr_sc6[,c(1,2)], "equal")
```

#### SC7 (Excitability)

Kappa = -0.132

```{r}
irr_sc7 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc7.csv", show_col_types = FALSE)

kappa2(irr_sc7[,c(1,2)], "equal")
```

#### SC8 (Playfulness)

Kappa = 0.0446

```{r}
irr_sc8 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc8.csv", show_col_types = FALSE)

kappa2(irr_sc8[,c(1,2)], "equal")
```

#### SC9 (Active Engagement)

Kappa = 0.199

```{r}
irr_sc9 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc9.csv", show_col_types = FALSE)

kappa2(irr_sc9[,c(1,2)], "equal")
```

#### SC10 (Companionability)

Kappa = 0.13

```{r}
irr_sc10 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc10.csv", show_col_types = FALSE)

kappa2(irr_sc10[,c(1,2)], "equal")
```

#### SC11 (Aggression Towards Pigs)

Kappa = 0.101

```{r}
irr_sc11 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc11.csv", show_col_types = FALSE)

kappa2(irr_sc11[,c(1,2)], "equal")
```

#### SC12 (Dominance Over Other Pigs)

Kappa = 0.269

```{r}
irr_sc12 <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_dfs/irr_sc12.csv", show_col_types = FALSE)

kappa2(irr_sc12[,c(1,2)], "equal")
```

### Graph comparing Kappa scores between sub-facets

```{r}
irr_results <- read_csv("https://raw.githubusercontent.com/nwstetson/PigPersonality/main/irr_results.csv", show_col_types = FALSE)

ggplot(irr_results, aes(x = Sub.facet, y = Kappa) ) + 
  geom_col(color = "navy", fill='lightsteelblue1') +
  theme_classic() +
  xlab("Personality Sub-Facet") +
  ylab("Kappa") +
  ggtitle("Inter-Rater Reliability Across Personality Scores") +
  geom_hline(yintercept=0.21, linetype="dashed", color = "red")
```

Mean IRR

```{r}
mean(irr_results$Kappa)
```

# Primary Analyses

Do personality scores correlate with observable behaviors?

Make DF with both

```{r}
behavior_and_scores <- inner_join(behavior_m, Avg_svy, by = "PigID")
```

### Aggression Towards other Pigs

```{r}
ggplot(behavior_and_scores, aes(x=Attempt.disp, y=SC11.Avg)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Displaced") +
  ylab("Aggression Score") +
  ggtitle("Do Pigs that Score Higher on Aggression Displace Other Pigs More?")

# Pearson's correlation
cor.test(behavior_and_scores$Attempt.disp, behavior_and_scores$SC11.Avg)
# cor = 0.285504 (weak positive correlation)
# p-value = 0.2224
```

```{r}
ggplot(behavior_and_scores, aes(x=Get.disp, y=SC11.Avg)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Displaced") +
  ylab("Aggression Score") +
  ggtitle("Do Pigs that Score Higher on Aggression Get Displaced Less?")

# Pearson's correlation
cor.test(behavior_and_scores$Get.disp, behavior_and_scores$SC11.Avg)
# cor = -0.397797 (moderate negative correlation)
# p-value = 0.08239
```

## Dominance Over Other Pigs

Hypothesis: A pig's Dominance Over Other Pigs score (SC12) positively correlates with number of counts of obs\$Attempt.displace and negatively correlates with number of counts of \$Get.displaced

### Does get.disp correlated with SC12 (dominance over pigs)

```{r}
ggplot(behavior_and_scores, aes(x=Get.disp, y=SC12.Avg)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Displaced") +
  ylab("Dominance Score") +
  ggtitle("Do Pigs that Score Higher on Dominance Get Displaced Less?")


# Pearson's correlation
cor.test(behavior_and_scores$Get.disp, behavior_and_scores$SC12.Avg)
# -0.2143021 (weak negative correlation)
```

What if it's split by sex?

```{r}
ggplot(behavior_and_scores, aes(x=Get.disp, y=SC12.Avg)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Displaced") +
  ylab("Dominance Score") +
  ggtitle("Do Pigs that Score Higher on Dominance Get Displaced Less?") +
  facet_wrap(~ Sex)


beh_sco_males <- behavior_and_scores %>% filter(Sex=="M")
beh_sco_females <- behavior_and_scores %>% filter(Sex=="F")

cor.test(beh_sco_males$Get.disp, beh_sco_males$SC12.Avg)
#-0.2460026 
cor.test(beh_sco_females$Get.disp, beh_sco_females$SC12.Avg)
# -0.1950034
```

#### Attempts at Displacement

```{r}
# Correlation between pig's SC12 vs # of times they attempted to displace another pig
ggplot(behavior_and_scores, aes(x=Attempt.disp, y=SC12)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Attempt Displace") +
  ylab("Dominance Score") +
  ggtitle("Do Pigs that Score Higher on Dominance Displace Pigs More?")

# Pearson's correlation
cor.test(behavior_and_scores$Attempt.disp, behavior_and_scores$SC12)
# 0.1807212 #also weak
```

## Active Engagement

Hypothesis: Active Engagement score negatively correlated with number of times pig was resting

(Josh said don't do this bc engagment might not be the opposite of resting smh)

```{r}
ggplot(behavior_and_scores, aes(x=Travel, y=SC9)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Traveling") +
  ylab("Active Engagement Score") +
  ggtitle("Do Pigs that Score High on Active Engagement Travel More?")

# Pearson's correlation
cor.test(behavior_and_scores$Travel, behavior_and_scores$SC9)
#0.3479849
```

## Resting in proximity vs companionability

```{r}
cor.test(behavior_and_scores$Rest.proxim, behavior_and_scores$SC1.Avg)
#SC1 = -0.2909014 (Fear of Humans)
#SC5 = 0.2015292 (General Aggression)
```

```{r}
ggplot(behavior_and_scores, aes(x=Attempt.disp, y=SC8.Avg)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Attempt Displace") +
  ylab("Playfulness Score") +
  ggtitle("Pigs that Displace Pigs More Score Lower in Playfulness")


# Displacing other pigs is negatively correlated with playfulness

# Pearson's correlation
cor.test(behavior_and_scores$Attempt.disp, behavior_and_scores$SC8.Avg)
# cor = -0.4235986

# Getting displaced by other pigs is positively correlated with Companionability (.462)
```

```{r}
# Pearson's correlation
cor.test(behavior_and_scores$SC10.Avg, behavior_and_scores$Get.disp)
# 0.461596

ggplot(behavior_and_scores, aes(x=SC10.Avg, y=Get.disp)) +
  geom_point() +
  stat_smooth(method = "lm") +
  xlab("Times Pig Gets Displaced") +
  ylab("Companionability Score") +
  ggtitle("Pigs that Score Higher in Companionability Get Displaced More")
```

## Top correlations overview

üêµ git push meta data and fix df **(numbers might need to changed)**

```{r}
# not ready cor.test(behavior_and_scores$sex_num, behavior_and_scores$time)
```

```{r}
svy_behav_matrix_table <- cor(behavior_and_scores[,c(2:21, 33:84)]) #takes out demographics

describe(svy_behav_matrix_table)
corrplot(svy_behav_matrix_table, addCoef.col = 1,
         number.cex = 0.6, tl.cex = 0.7)

corrplot(svy_behav_matrix_table, addCoef.col = 1,
         number.cex = 0.4, tl.cex = 0.5, order="hclust", type="upper")
```

```{r}
behavior_and_scores
```

```{r}
library(lares)
svy_behav <- behavior_and_scores %>% select(2:21, 33:84)

library(lares) 
corr_cross(svy_behav, # dataset
           max_pvalue = 0.05, # show only sig. correlations at selected level
           top = 25)# display top 10 correlations, any couples of variables  )
           
corr_var(svy_behav, # dataset
         Get.disp, # name of variable to focus on
         top = 10) # display top 10 correlations
```

# Additional Analyses

## Subscale Analyses

Compare sex, group, and presence/absence of traumatic background with personality traits accross all pigs

Other ideas:

Maybe average \[trait\] score for \[group 1\] and \[group 2\] or something like that

Make social networks for Yaupon and Beautyberry

### Is there a sex difference in personality scores?

idk

```{r}
ggplot(svy_wide, aes(x= sub.facet, y= subfacet.value, fill = Sex)) +
  geom_boxplot() +
  theme_classic() +
  scale_fill_manual(values = c("powderblue", "goldenrod1")) +
  xlab("Personality Sub-Facet") +
  ylab("Score") +
  ggtitle("Sex Differences in Personality Scores Across 20 Pigs")

```

```{r}
ggplot(svy_wide, aes(x= facet, y= facet.value, fill = Sex)) +
  geom_boxplot() +
  theme_classic() +
  scale_fill_manual(values = c("powderblue", "goldenrod1")) +
  xlab("Personality Facet") +
  ylab("Score") +
  ggtitle("Sex Differences in Personality Scores Across 20 Pigs")

```

```{r}
ggplot(svy_wide, aes(x= facet, y= facet.value, fill = Background)) +
  geom_boxplot() +
  theme_classic() +
  scale_fill_manual(values = c("seagreen1", "lightblue1")) +
  xlab("Personality Sub-Facet") +
  ylab("Score") +
  ggtitle("Variation in Personality Scores Across 20 Pigs")
```

Background difference?

```{r}
ggplot(svy_wide, aes(x= sub.facet, y= subfacet.value, fill = Background)) +
  geom_boxplot() +
  theme_classic() +
  scale_fill_manual(values = c("seagreen1", "lightblue1")) +
  xlab("Personality Sub-Facet") +
  ylab("Score") +
  ggtitle("Variation in Personality Scores Across 20 Pigs")
```

### Sex differences in getting displaced???

Males maybeee get displaced less???

```{r}
ggplot(behavior_m, aes(x=Get.disp, fill = Sex)) + 
   theme_classic() +
  xlab("Times Getting Displaced") +
  ylab("umm math i think") +
  ggtitle("Do Male Pigs Get Displaced Less Than Female Pigs?") +
  geom_density(alpha = 0.4) +
  theme_minimal() +
  scale_fill_manual(values = c("goldenrod1", "darkorchid4"))


ggplot(behavior_m, aes(x=Get.disp, fill = Sex)) + 
   theme_classic() +
  xlab("Times Getting Displaced") +
  ylab("umm math i think") +
  ggtitle("Do Male Pigs Get Displaced Less Than Female Pigs?") +
  geom_hist() +
  theme_minimal() +
  scale_fill_manual(values = c("goldenrod1", "darkorchid4"))
```

### Background differences in getting displaced

```{r}
ggplot(behavior_m, aes(x=Get.disp, fill=Background)) + #fix name in DF later
  theme_classic() +
  xlab("Get Displaced") +
  ylab("Proportion") +
  ggtitle("Do Pigs From Abuse/Neglect Backgrounds Get Displaced More?") +
  geom_density(alpha = 0.4) +
  theme_minimal() +
  scale_fill_manual(name= "Background", labels=c("Abuse/Neglect", "Other"), values = c("brown2", "darkblue"))
```

## Potential Moderators

```{r}
# Compare length of time volunteer has known pig with correlations bewteen surveys and traits from Primary Analyses???
```

Factor analysis

```{r}
```
